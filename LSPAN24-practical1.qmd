---
title: "Handling different data types, quality checking and preparing data files"
author: "Barbara Lazzari, Matilde Passamonti, Paolo Cozzi, Stefano Capomaccio"
format: 
  revealjs:
    chalkboard: true
    footer: "Livestock pangenomes 2024 - Practical 1 - 2024/07/22"
---

## Practical introduction

To follow this and other practicals, a working *NIX environment is required. 
We suggest to use a Linux distribution, MacOS or Windows with
[WSL2](https://learn.microsoft.com/en-us/windows/wsl/about).

If you don't have a working environment, you can use [GitPod](https://www.gitpod.io/),
a cloud-based IDE that allows you to work on your projects from anywhere. We suggest:

*   A [GitHub](https://github.com/) account to manage authentication. 
*   A [Linkedin](https://www.linkedin.com/) account to get access to 50 hours of 
    free usage per month.

::: notes
Introducing GitPod: is not mandatory for the practicals, but it is a good way to
work on the practicals without the need to install anything on your local machine.
This can be useful if you have a slow internet connection, or if you are not allowed
to install software on your machine.
In the GitPod environment, we manage the software installation and the environment
but you can install additional software if needed.
:::

## Introduction to GitPod

Go to <https://www.gitpod.io/> and select the **Try for free** button

![](img/gitpod_home.png){fig-align="center" .r-stretch}

## Link your GitHub account to GitPod (recommended)

Add your *linkedin* account to get 50 hours of free usage per month

![](img/gitpod_login.png){fig-align="center" .r-stretch}

::: notes
Select your preferred editor (VS code is recommened), 
theme, and profile details, click continue and your 
account will be created and ready to use.
:::

## GitPod pricing plans

![](img/gitpod_pricing.png){fig-align="center" .r-stretch}

::: notes
GitPod has a free tier that allows you to use the service for 50 hours per month.
You don't need to provide any payment details to follow these practicals.
:::

See your resource usage at <https://gitpod.io/billing>

## GitPod Workspaces

<https://gitpod.io/workspaces>

![](img/gitpod_workspace.png){fig-align="center" .r-stretch}

::: notes
A workspace is a cloud-based development environment that allows you to work on your
projects from anywhere. You can create a workspace from a GitHub repository, or you
can create an empty workspace and clone a repository from the terminal.
Here you can see a list of your active workspaces, the status, the time of the last
activity, and the instance size (if any).
:::

## Create a workspace

![](img/gitpod_create_workspace.png){.r-stretch}

::: notes
when creating a workspace, you can select a repository from GitHub, the default
editor and the instance size. If you use the *Large* instance, you will consume
your free credits **faster**
:::

## VS Code in GitPod

![](img/gitpod_vscode.png){fig-align="center" .r-stretch}

Take a look at VS Code tutorial, for example [this one](https://www.youtube.com/watch?v=B-s71n0dHUk)

::: notes
Please note the 4 different sections of the VS Code interface: at the bottom is 
the terminal, on the left is the file explorer, in the middle is the editor, and
on the left-up corner is the hamburger menu that allows you to access the settings
and the extensions.
:::

## Turning off Workspaces

![](img/gitpod_stopworkspace.1.png){.absolute top=100 left=0 width="auto" height="500"}
![](img/gitpod_stopworkspace.2.png){.absolute bottom=0 right=0 width="700" height="auto"}

::: notes
Remember to stop your workspace when you are not using it, to save your free credits.
You can stop your current workspace by clicking on the hamburger menu fromn VScode 
or from the hamburger menu in the workspace list
:::

## Workspaces lifecycle

::: incremental
*   Workspaces are automatically stopped after 30 minutes of inactivity or after
    8 hours (using a free plan)
    +   Only files and directories inside `/workspace` directory are preserved.
*   Workspaces are deleted after **14 days**
    +   remember to save your work
*   Please see [Workspace Lifecycle](https://www.gitpod.io/docs/configure/workspaces/workspace-lifecycle)
    for more information
:::

## Introduction to virtual environment

Something on virtual environments in general. Then introduce conda and mamba.

-   Python: virtualenv, pyenv, poetry
-   R: packrat, renv
-   Perl: perlbrew, local::lib
-   Ruby: rvm

::: notes
something on reproducibility and the need for virtual environments.
:::

## Introduction to Conda

-   [Conda](https://docs.anaconda.com/anaconda/install/): A package manager and environment management system for installing and managing software packages and dependencies, particularly for Python and R.

::: incremental
-   [Miniconda](https://docs.anaconda.com/miniconda/): A minimal installer for Conda that includes Conda, Python, and other essential packages.
-   [Mamba](https://mamba.readthedocs.io/en/latest/installation/mamba-installation.html): A faster, drop-in replacement for Conda. You can swap almost all commands between `conda` & `mamba`
:::

::: notes
conda to install dependencies and softwares
Conda: has navigators, softwares for installing packages using GUI and editors like spyder, jupyter notebook, etc. Suggested on local machines. Miniconda: is a lightweight version of Conda, suggested on servers or where the GUI is not available. Mamba: implemented the package resolvers in C++ and is faster than Conda. However conda has introduced a new package resolver last year. It has some additional features like `repoquery`.
:::

## Create an environment (from scratch)

We use `conda` command to manage environments with `conda` / `miniconda`:

-   replace with `mamba` if you have `mamba` installed.
-   `--name`: required to specify the name of the environment.
-   specifying versions helps the package resolver

``` {.bash code-line-numbers="1-2|4-5|7-8"}
# create an empty environment
conda create --name empty

# create an environment with some software
conda create --name python python ipython

# create an environment with a specific software version
conda create --name python3.10 python=3.10 ipython=8.25
```

## Create an environment (from file)

We can also create an environment from a file. Note the `env` before the `create` command:

-   `--file`: specify the file containing the environment specifications
-   `--name`: override the name of the environment in the file

``` {.bash code-line-numbers="1-2"}
# create an environment from a file
conda env create --file environment.yml
```

::: notes
without the `--file` option, the current `environment.yml` file will be used.
:::

## List and activate environments

-   `conda env list`: list all environments
-   `conda activate <env_name>`: activate an environment

Normally the prompt will change to show the active environment. Default installation
have the `base` environment active at login

```bash
(base) paolo@bullseye-laptop:~$ conda activate ognigenoma
(ognigenoma) paolo@bullseye-laptop:~$
```

## Channels and repositories

-   `defaults`: the default channel for conda packages
-   `bioconda`: a channel for bioinformatics software
-   `R`: a channel for R packages
-   `conda-forge`: a community-driven collection of conda packages

``` {.bash code-line-numbers="1-2"}
# add a channel to the list of channels
conda config --add channels conda-forge

# add a channel to the list of channels
conda config --add channels bioconda
```

## Search for packages

## Install packages

*   `conda install`: install packages in the active environment
    +   `--name`: specify the environment to install the package
    +   `--file`: specify a file with the list of packages to install

``` {.bash code-line-numbers="1-2|4-5|7-9"}
# install a package in the active environment
conda install pandas

# install a package in a specific environment
conda install --name python3.10 pandas

# install packages from a file in the active environment 
# (python format)
conda install --file requirements.txt
```

## Exporting an environment

-   `conda env export`: export the environment to a file
-   `--name`: specify the environment to export
-   `--file`: specify the file to export the environment to
-   `--no-builds`: exclude the build string from the exported file

``` {.bash code-line-numbers="1-2|4-5|7-8"}
# export the active environment to a file (using STDOUT)
conda env export > environment.yml

# export a specific environment to a file
conda env export --name python3.10 > environment.yml

# export a specific environment to a specific file
conda env export --name python3.10 --file environment.yml
```

::: notes
does people know STDOUT/STDERR/STDIN?
:::

## Some tips

::: incremental
-   `conda list`: list all packages installed in the active environment
-   Install packages with versions: `conda install pandas=1.3.3`
-   Create environments by scope: don't pull all packages in the same environment
-   Limit the `conda-forge` channel usage if possible
-   `conda list --revision`: list all revisions of the environment
:::
